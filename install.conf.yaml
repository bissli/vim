- defaults:
    crossplatform-link:
      create: true
      relink: true
      force: true
      fallback_to_copy: true
    shell:
      stdin: true
      stdout: true
      stderr: true

- shell:
  - [git submodule init, Initializing submodules]
  - [git submodule update, Updating submodules]

- crossplatform-shell:
  - command: git submodule foreach 'git checkout $(git branch | grep -o -m1 "\b\(master\|main\)\b")' &> /dev/null
    description: Checkout out master for each submodule
    platform: linux

- crossplatform-link:
  - ~/.vim:
      path: .
      platform: linux
  - ~/_ideavimrc:
      path: ideavimrc
      platform: win32

- crossplatform-shell:
  - command: curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
    description: Installing vim-plug
    platform: linux
  - command: touch ~/.fzf_history
    description: Creating fzf history file
    platform: linux
  - command: mkdir -p ~/.config/vim/plugged && mkdir -p ~/.config/vim/session && mkdir -p ~/.config/vim/servers
    platform: linux

- crossplatform-link:
  - ~/.vim/plugged: ~/.config/vim/plugged
  - ~/.vim/servers: ~/.config/vim/servers
  - ~/.vim/session: ~/.config/vim/session

- crossplatform-shell:
  - command: vim -Nu ~/.vim/plug.vim +PlugInstall +PlugClean! +qall
    platform: linux

- clean: ["~/.vim"]
